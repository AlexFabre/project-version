# c-versionner

A little POSIX shell script that generates version information for your C project.

Works by parsing the git describe command to retrieve all information since the last tag found.

## Usage

Copy the script in your git working repo and let the magic happen.

All available options can be listed with option `-h`

~~~sh
$ ./c-versionner.sh -h
==> c-versionner.sh 0.4.0
A little POSIX shell script to generate
version information for your C project
Usage:
c-versionner.sh [options]
-o <output file path>
-f <tag format> (default 'v')
-h <help>
-v <script version>
-l <script logs> (default none)
~~~

### Example of generated header

~~~c
/**
 * @file version.h
 * @brief version information of project build
 *
 * Generated with c-versionner.sh 0.4.0
 * A little POSIX shell script to generate
 * version information for your C project
 *
 * @warning Do not edit this file manually. Its content
 * is generated with c-versionner.sh script.
 */
#ifndef VERSION_H__
#define VERSION_H__

/* Project version */
#define VERSION_MAJOR                     0
#define VERSION_MINOR                     3
#define VERSION_PATCH                     2

/* Git repo info */
#define VERSION_BRANCH_NAME               "setting-ci"
#define VERSION_NB_COMMITS_SINCE_LAST_TAG 10
#define VERSION_COMMIT_SHORT_SHA          "7f12c86"

/* Build date time (UTC) */
#define VERSION_BUILD_DAY                 6
#define VERSION_BUILD_MONTH               8
#define VERSION_BUILD_YEAR                2024
#define VERSION_BUILD_HOUR                6

#endif /* VERSION_H__ */
~~~

## Code quality
- Shellcheck
- Codespell

## TODO List

* Path handling in `file_path_checker` function: The function currently assumes that the provided path always ends with a filename. If the input path doesn't have a filename or extension, it defaults to `version.h`. This could lead to incorrect behavior in some cases. Consider validating the input path and handling errors more explicitly.
* Zephyr compliance: Zephyr project uses a VERSION file, similar to what is currently generated. Through an option, the script should be able to generate this VERSION file. 
https://docs.zephyrproject.org/latest/build/version/index.html